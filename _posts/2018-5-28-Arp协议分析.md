---
layout: post
title: Arp协议分析
description: Arp协议分析
category: 网络协议分析
---

## Arp协议格式

![](https://i.imgur.com/Wh3Tgm0.png)

- 协议类型：0x0800(ipv4)
- 操作类型：0x0001(请求),0x0002(响应)
- 硬件（协议）长度单位:1字节

## Arp工作原理
![](https://i.imgur.com/aNPTLL1.png)

### 1 请求获取目的主机的物理地址
1. 主机A调用ARP，请求IP地址是“195.167.0.15” 的目的主机的物理地址。
2. ARP创建一个ARP请求数据报，其内容包括：源主机A的物理地址、源主机A的IP地址和目的主机B的IP地址。
3. 主机A在本地网络中广播ARP请求数据报，请求数据报的目的地址为广播地址。

### 2 向发送请求物理地址的主机回送解析结果

1. 由于是广播发送，该网络中所有的主机都能接收到ARP请求的数据报，并将ARP请求数据报中的目的主机的IP地址与自己的IP地址进行匹配，如果不匹配则忽略该数据报的处理。
2. 如果某主机发现请求数据报中的目的IP地址与自己的IP地址一致，如图中的主机B，则产生一个包含自己的物理地址的ARP应答数据报，其中包含：应答主机物理地址，应答主机IP地址，请求主机的物理地址和请求主机的IP地址。
3. ARP应答数据报直接以单播形式回送给发送ARP请求数据报的主机A。
4. 主机A利用应答数据报中得到的应答主机B的物理地址，完成地址解析过程。

*注：请求时广播发送，响应时单播发送，采用缓存提高网络工作效率*

## 数据帧分析
![](https://i.imgur.com/d3K647M.png)
